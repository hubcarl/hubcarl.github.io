---
layout: webpack/webpack 
description: "专注于技术,切不能沉迷于技术!"
---

## 背景

随着越来越多的项目采用vue, react, weex进行业务开发, 在前端构建方面大多数是用Webpack 进行构建。但存在以下问题：

- 各个项目都是自己从零编写Webpack 配置，存在很多定制性的配置，无法复用，大多都是复制拷贝。
- Webpack  配置项多，当需要满足开发环境，测试环境，压缩，cdn，单页面，多页面， 热更新, 客户端渲染，服务器渲染等特性时，配置非常复杂。

在前端工程构建方面迫切需要一套基于 Webpack  的通用且可扩展性强的前端工程化解决方案.


## 我们要解决什么问题

针对背景里面提到的一些问题, 基于Webpack  + egg项目的工程化, 当初想到和后面实践中遇到问题, 主要有如下问题需要解决:

- Vue Server Side Render 工程该如何搭建?

- Webpack 客户端(browser)运行模式打包支持

- Webpack 服务端(node)运行模式打包支持

- 如何实现服务端和客户端代码修改 Webpack 热更新功能

- Webpack 打包配置太复杂(客户端,服务端), 如何简化和多项目复用

- 开发, 测试, 正式等多环境支持, css/js/image的压缩和hash, cdn等功能如何配置, 页面依赖的css和js如何加载

- 如何快速扩展出基于vue, react前端框架服务端和客户端渲染的解决方案


## Webpack 工程化设计

我们知道Webpack 是一个前端打包构建工具, 功能强大, 意味的配置也会复杂. 我们可以通过针对vue, react等前端框架,采用不同的配置构建不同的解决方案.
虽然这样能实现, 但持续维护的成本大, 多项目使用时就只能采用拷贝的方式, 另外还有一些优化和打包技巧都需要各自处理.

基于以上的一些问题和想法, 我希望基于 Webpack 的前端工程方案大概是这个样子:

- Webpack 太复杂, 项目可重复性和维护性低, 是不是可以把基础的配置固化, 然后基于基础的配置扩展出具体的解决方案(vue/react等打包方案).

- Webpack 配置支持多环境配置, 根据环境很方便的设置是否开启source-map, hash, 压缩等特性.

- Webpack 配置的普通做法是写配置, 是不是可以采用面向对象的方式来编写配置.

- 能够基于基础配置很简单的扩展出基于 vue, react 服务端渲染的解决方案

- 针对 Egg + Webpack 内存编译和热更新功能与框架无关, 可以抽离出来, 做成通用的插件